<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>íšŒì‚¬ ë¯¸í™”ì§ ì²­ì†Œ ì²´í¬ë¦¬ìŠ¤íŠ¸</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body { font-family: sans-serif; padding: 20px; background: #f8f8f8; }
    h2 { color: #333; }
    table { width: 100%; border-collapse: collapse; margin-top: 20px; background: white; }
    th, td { border: 1px solid #ccc; padding: 10px; text-align: center; }
    th { background-color: #efefef; }
    input[type="text"], select { width: 95%; padding: 5px; }
    input[type="checkbox"] { transform: scale(1.2); }
    .highlight { background-color: #ffe0e0 !important; }
    .controls { margin-top: 15px; }
    .progress-bar { margin-top: 10px; font-weight: bold; }
    .btn-copy { margin-left: 10px; }
    #saved-logs { margin-top: 30px; padding: 10px; background: #e6f2ff; white-space: pre-wrap; }
    #log-filter { margin-top: 10px; }
  </style>
</head>
<body>
  <h2>íšŒì‚¬ ë¯¸í™”ì§ ì²­ì†Œ ì²´í¬ë¦¬ìŠ¤íŠ¸</h2>
  <p><strong>ì˜¤ëŠ˜ ë‚ ì§œ:</strong> <span id="today"></span></p>

  <div>
    <button onclick="addRow()">í•­ëª© ì¶”ê°€</button>
    <button onclick="generateReport()">ë¦¬í¬íŠ¸ ìƒì„±</button>
    <button onclick="saveLog()">ê¸°ë¡ ì €ì¥</button>
  </div>

  <div id="log-filter">
    <label for="logPeriod">ë¦¬í¬íŠ¸ ë³´ê¸°:</label>
    <select id="logPeriod" onchange="filterLogs()">
      <option value="all">ì „ì²´</option>
      <option value="week">ìµœê·¼ 7ì¼</option>
      <option value="month">ìµœê·¼ 30ì¼</option>
    </select>
  </div>

  <table id="checklist">
    <thead>
      <tr>
        <th>ì¸µ</th>
        <th>êµ¬ì—­</th>
        <th>í•­ëª©</th>
        <th>ì£¼ê¸°</th>
        <th>ì™„ë£Œ</th>
        <th>ì ê²€í•„ìš”</th>
        <th>ë‹´ë‹¹ì</th>
        <th>íŠ¹ì´ì‚¬í•­</th>
      </tr>
    </thead>
    <tbody id="checklist-body">
      <tr>
        <td><input type="text" placeholder="ì˜ˆ: 1ì¸µ"></td>
        <td><input type="text" placeholder="ì˜ˆ: í™”ì¥ì‹¤"></td>
        <td><input type="text" placeholder="ì˜ˆ: ì„¸ë©´ëŒ€"></td>
        <td><select><option>ì¼ê°„</option><option>ì£¼ê°„</option><option>ì›”ê°„</option></select></td>
        <td><input type="checkbox" class="done"></td>
        <td><input type="checkbox"></td>
        <td><input type="text" class="signer"></td>
        <td><input type="text" placeholder="íŠ¹ì´ì‚¬í•­"></td>
      </tr>
    </tbody>
  </table>

  <div class="controls">
    <button onclick="resetChecklist()">ì´ˆê¸°í™”</button>
    <button onclick="window.print()">PDF ì¶œë ¥</button>
    <button onclick="copyChecklist()" class="btn-copy">ë³µì‚¬</button>
    <div class="progress-bar">ì§„í–‰ë¥ : <span id="progress">0%</span></div>
  </div>

  <div id="report-output" style="margin-top: 20px; white-space: pre-wrap; background: #f4f4f4; padding: 10px;"></div>
  <div id="saved-logs"></div>

  <script>
    document.getElementById('today').textContent = new Date().toLocaleDateString();

    function updateProgress() {
      const checks = document.querySelectorAll('.done');
      const total = checks.length;
      const done = [...checks].filter(cb => cb.checked).length;
      const percent = total ? Math.round((done / total) * 100) : 0;
      document.getElementById('progress').textContent = percent + '%';
    }

    function addRow() {
      const tbody = document.getElementById('checklist-body');
      const row = document.createElement('tr');
      row.innerHTML = `
        <td><input type="text" placeholder="ì˜ˆ: 1ì¸µ"></td>
        <td><input type="text" placeholder="ì˜ˆ: íšŒì˜ì‹¤"></td>
        <td><input type="text" placeholder="ì˜ˆ: ë°”ë‹¥"></td>
        <td><select><option>ì¼ê°„</option><option>ì£¼ê°„</option><option>ì›”ê°„</option></select></td>
        <td><input type="checkbox" class="done"></td>
        <td><input type="checkbox"></td>
        <td><input type="text" class="signer"></td>
        <td><input type="text" placeholder="íŠ¹ì´ì‚¬í•­"></td>
      `;
      tbody.appendChild(row);
      row.querySelectorAll('.done').forEach(cb => cb.addEventListener('change', updateProgress));
    }

    function resetChecklist() {
      document.querySelectorAll('input[type="checkbox"]').forEach(cb => cb.checked = false);
      document.querySelectorAll('.signer').forEach(input => input.value = '');
      updateProgress();
    }

    function copyChecklist() {
      const checklist = document.getElementById('checklist-body');
      const text = checklist.innerText;
      navigator.clipboard.writeText(text).then(() => alert('ì²´í¬ë¦¬ìŠ¤íŠ¸ê°€ ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤.'));
    }

    function generateReport() {
      const date = new Date().toLocaleString();
      const rows = document.querySelectorAll('#checklist-body tr');
      const report = [`ğŸ“… ë¦¬í¬íŠ¸ ìƒì„± ì‹œê°: ${date}\n`];
      rows.forEach(row => {
        const ì¸µ = row.cells[0].querySelector('input')?.value || '';
        const êµ¬ì—­ = row.cells[1].querySelector('input')?.value || '';
        const í•­ëª© = row.cells[2].querySelector('input')?.value || '';
        const ì£¼ê¸° = row.cells[3].querySelector('select')?.value || '';
        const ì™„ë£Œ = row.cells[4].querySelector('input')?.checked ? 'ì™„ë£Œ' : 'ë¯¸ì™„ë£Œ';
        const ì ê²€ = row.cells[5].querySelector('input')?.checked ? 'ì ê²€í•„ìš”' : '';
        const ë‹´ë‹¹ì = row.cells[6].querySelector('input')?.value || '';
        const íŠ¹ì´ì‚¬í•­ = row.cells[7].querySelector('input')?.value || '';
        report.push(`${ì£¼ê¸°} | ${ì¸µ} - ${êµ¬ì—­} - ${í•­ëª©} | ìƒíƒœ: ${ì™„ë£Œ}${ì ê²€ ? ', ' + ì ê²€ : ''} | ë‹´ë‹¹ì: ${ë‹´ë‹¹ì}${íŠ¹ì´ì‚¬í•­ ? ' | íŠ¹ì´ì‚¬í•­: ' + íŠ¹ì´ì‚¬í•­ : ''}`);
      });
      document.getElementById('report-output').textContent = report.join('\n');
    }

    function saveLog() {
      const now = new Date();
      const dateKey = now.toISOString();
      const reportText = document.getElementById('report-output').textContent;
      const logs = JSON.parse(localStorage.getItem('checklistLogs') || '{}');
      logs[dateKey] = reportText;
      localStorage.setItem('checklistLogs', JSON.stringify(logs));
      loadLogs();
    }

    function loadLogs() {
      const logs = JSON.parse(localStorage.getItem('checklistLogs') || '{}');
      const container = document.getElementById('saved-logs');
      const period = document.getElementById('logPeriod')?.value || 'all';
      const now = new Date();
      const output = [];

      Object.entries(logs).forEach(([dateKey, content]) => {
        const logDate = new Date(dateKey);
        const diffDays = (now - logDate) / (1000 * 60 * 60 * 24);
        if (
          period === 'all' ||
          (period === 'week' && diffDays <= 7) ||
          (period === 'month' && diffDays <= 30)
        ) {
          output.push(`ğŸ“Œ [${logDate.toLocaleString()} ê¸°ë¡]\n${content}\n------------------------------\n`);
        }
      });

      container.textContent = output.join('\n');
    }

    function filterLogs() {
      loadLogs();
    }

    document.addEventListener('change', updateProgress);
    updateProgress();
    loadLogs();
  </script>
</body>
</html>
